/**
* Copyright 2016 Comcast Cable Communications Management, LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
 */

package gaad

import (
	"fmt"

	"github.com/Comcast/gaad/bitreader"
)

// Implementation adapted from MediaInfo Project and FAAD2
// https://mediaarea.net/en/MediaInfo
// http://www.audiocoding.com/faad2.html
//
// MediaInfo and FAAD2's implementation are from:
// "SELECTING AN OPTIMAL HUFFMAN DECODER FOR AAC"
// VLADIMIR Z. MESAROVIC , RAGHUNATH RAO, MIROSLAV V. DOKIC, and SACHIN DEO
// AES Convention Paper 5436

type hcb_struct_1 struct {
	Offset uint8
	Extra  uint8
}

type hcb_struct [5]int8

// Scale Factor Huffman Codebook (flattened into a 2d array)
var huffman_sf = [241][2]uint8{
	{1, 2},
	{60, 0},
	{1, 2},
	{2, 3},
	{3, 4},
	{59, 0},
	{3, 4},
	{4, 5},
	{5, 6},
	{61, 0},
	{58, 0},
	{62, 0},
	{3, 4},
	{4, 5},
	{5, 6},
	{57, 0},
	{63, 0},
	{4, 5},
	{5, 6},
	{6, 7},
	{7, 8},
	{56, 0},
	{64, 0},
	{55, 0},
	{65, 0},
	{4, 5},
	{5, 6},
	{6, 7},
	{7, 8},
	{66, 0},
	{54, 0},
	{67, 0},
	{5, 6},
	{6, 7},
	{7, 8},
	{8, 9},
	{9, 10},
	{53, 0},
	{68, 0},
	{52, 0},
	{69, 0},
	{51, 0},
	{5, 6},
	{6, 7},
	{7, 8},
	{8, 9},
	{9, 10},
	{70, 0},
	{50, 0},
	{49, 0},
	{71, 0},
	{6, 7},
	{7, 8},
	{8, 9},
	{9, 10},
	{10, 11},
	{11, 12},
	{72, 0},
	{48, 0},
	{73, 0},
	{47, 0},
	{74, 0},
	{46, 0},
	{6, 7},
	{7, 8},
	{8, 9},
	{9, 10},
	{10, 11},
	{11, 12},
	{76, 0},
	{75, 0},
	{77, 0},
	{78, 0},
	{45, 0},
	{43, 0},
	{6, 7},
	{7, 8},
	{8, 9},
	{9, 10},
	{10, 11},
	{11, 12},
	{44, 0},
	{79, 0},
	{42, 0},
	{41, 0},
	{80, 0},
	{40, 0},
	{6, 7},
	{7, 8},
	{8, 9},
	{9, 10},
	{10, 11},
	{11, 12},
	{81, 0},
	{39, 0},
	{82, 0},
	{38, 0},
	{83, 0},
	{7, 8},
	{8, 9},
	{9, 10},
	{10, 11},
	{11, 12},
	{12, 13},
	{13, 14},
	{37, 0},
	{35, 0},
	{85, 0},
	{33, 0},
	{36, 0},
	{34, 0},
	{84, 0},
	{32, 0},
	{6, 7},
	{7, 8},
	{8, 9},
	{9, 10},
	{10, 11},
	{11, 12},
	{87, 0},
	{89, 0},
	{30, 0},
	{31, 0},
	{8, 9},
	{9, 10},
	{10, 11},
	{11, 12},
	{12, 13},
	{13, 14},
	{14, 15},
	{15, 16},
	{86, 0},
	{29, 0},
	{26, 0},
	{27, 0},
	{28, 0},
	{24, 0},
	{88, 0},
	{9, 10},
	{10, 11},
	{11, 12},
	{12, 13},
	{13, 14},
	{14, 15},
	{15, 16},
	{16, 17},
	{17, 18},
	{25, 0},
	{22, 0},
	{23, 0},
	{15, 16},
	{16, 17},
	{17, 18},
	{18, 19},
	{19, 20},
	{20, 21},
	{21, 22},
	{22, 23},
	{23, 24},
	{24, 25},
	{25, 26},
	{26, 27},
	{27, 28},
	{28, 29},
	{29, 30},
	{90, 0},
	{21, 0},
	{19, 0},
	{3, 0},
	{1, 0},
	{2, 0},
	{0, 0},
	{23, 24},
	{24, 25},
	{25, 26},
	{26, 27},
	{27, 28},
	{28, 29},
	{29, 30},
	{30, 31},
	{31, 32},
	{32, 33},
	{33, 34},
	{34, 35},
	{35, 36},
	{36, 37},
	{37, 38},
	{38, 39},
	{39, 40},
	{40, 41},
	{41, 42},
	{42, 43},
	{43, 44},
	{44, 45},
	{45, 46},
	{98, 0},
	{99, 0},
	{100, 0},
	{101, 0},
	{102, 0},
	{117, 0},
	{97, 0},
	{91, 0},
	{92, 0},
	{93, 0},
	{94, 0},
	{95, 0},
	{96, 0},
	{104, 0},
	{111, 0},
	{112, 0},
	{113, 0},
	{114, 0},
	{115, 0},
	{116, 0},
	{110, 0},
	{105, 0},
	{106, 0},
	{107, 0},
	{108, 0},
	{109, 0},
	{118, 0},
	{6, 0},
	{8, 0},
	{9, 0},
	{10, 0},
	{5, 0},
	{103, 0},
	{120, 0},
	{119, 0},
	{4, 0},
	{7, 0},
	{15, 0},
	{16, 0},
	{18, 0},
	{20, 0},
	{17, 0},
	{11, 0},
	{12, 0},
	{14, 0},
	{13, 0},
}

// Spectrum Huffman Codebook 1
var huffman_01_1 = []hcb_struct_1{
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{1, 0},
	{2, 0},
	{3, 0},
	{4, 0},
	{5, 0},
	{6, 0},
	{7, 0},
	{8, 0},
	{9, 2},
	{13, 2},
	{17, 2},
	{21, 2},
	{25, 2},
	{29, 2},
	{33, 4},
	{49, 6},
}

var huffman_01 = []hcb_struct{
	{1, 0, 0, 0, 0},
	{5, 1, 0, 0, 0},
	{5, -1, 0, 0, 0},
	{5, 0, 0, 0, -1},
	{5, 0, 1, 0, 0},
	{5, 0, 0, 0, 1},
	{5, 0, 0, -1, 0},
	{5, 0, 0, 1, 0},
	{5, 0, -1, 0, 0},
	{7, 1, -1, 0, 0},
	{7, -1, 1, 0, 0},
	{7, 0, 0, -1, 1},
	{7, 0, 1, -1, 0},
	{7, 0, -1, 1, 0},
	{7, 0, 0, 1, -1},
	{7, 1, 1, 0, 0},
	{7, 0, 0, -1, -1},
	{7, -1, -1, 0, 0},
	{7, 0, -1, -1, 0},
	{7, 1, 0, -1, 0},
	{7, 0, 1, 0, -1},
	{7, -1, 0, 1, 0},
	{7, 0, 0, 1, 1},
	{7, 1, 0, 1, 0},
	{7, 0, -1, 0, 1},
	{7, 0, 1, 1, 0},
	{7, 0, 1, 0, 1},
	{7, -1, 0, -1, 0},
	{7, 1, 0, 0, 1},
	{7, -1, 0, 0, -1},
	{7, 1, 0, 0, -1},
	{7, -1, 0, 0, 1},
	{7, 0, -1, 0, -1},
	{9, 1, 1, -1, 0},
	{9, -1, 1, -1, 0},
	{9, 1, -1, 1, 0},
	{9, 0, 1, 1, -1},
	{9, 0, 1, -1, 1},
	{9, 0, -1, 1, 1},
	{9, 0, -1, 1, -1},
	{9, 1, -1, -1, 0},
	{9, 1, 0, -1, 1},
	{9, 0, 1, -1, -1},
	{9, -1, 1, 1, 0},
	{9, -1, 0, 1, -1},
	{9, -1, -1, 1, 0},
	{9, 0, -1, -1, 1},
	{9, 1, -1, 0, 1},
	{9, 1, -1, 0, -1},
	{9, -1, 1, 0, -1},
	{9, -1, 1, 0, -1},
	{9, -1, 1, 0, -1},
	{9, -1, 1, 0, -1},
	{9, -1, -1, -1, 0},
	{9, -1, -1, -1, 0},
	{9, -1, -1, -1, 0},
	{9, -1, -1, -1, 0},
	{9, 0, -1, -1, -1},
	{9, 0, -1, -1, -1},
	{9, 0, -1, -1, -1},
	{9, 0, -1, -1, -1},
	{9, 0, 1, 1, 1},
	{9, 0, 1, 1, 1},
	{9, 0, 1, 1, 1},
	{9, 0, 1, 1, 1},
	{9, 1, 0, 1, -1},
	{9, 1, 0, 1, -1},
	{9, 1, 0, 1, -1},
	{9, 1, 0, 1, -1},
	{9, 1, 1, 0, 1},
	{9, 1, 1, 0, 1},
	{9, 1, 1, 0, 1},
	{9, 1, 1, 0, 1},
	{9, -1, 1, 0, 1},
	{9, -1, 1, 0, 1},
	{9, -1, 1, 0, 1},
	{9, -1, 1, 0, 1},
	{9, 1, 1, 1, 0},
	{9, 1, 1, 1, 0},
	{9, 1, 1, 1, 0},
	{9, 1, 1, 1, 0},
	{10, -1, -1, 0, 1},
	{10, -1, -1, 0, 1},
	{10, -1, 0, -1, -1},
	{10, -1, 0, -1, -1},
	{10, 1, 1, 0, -1},
	{10, 1, 1, 0, -1},
	{10, 1, 0, -1, -1},
	{10, 1, 0, -1, -1},
	{10, -1, 0, -1, 1},
	{10, -1, 0, -1, 1},
	{10, -1, -1, 0, -1},
	{10, -1, -1, 0, -1},
	{10, -1, 0, 1, 1},
	{10, -1, 0, 1, 1},
	{10, 1, 0, 1, 1},
	{10, 1, 0, 1, 1},
	{11, 1, -1, 1, -1},
	{11, -1, 1, -1, 1},
	{11, -1, 1, 1, -1},
	{11, 1, -1, -1, 1},
	{11, 1, 1, 1, 1},
	{11, -1, -1, 1, 1},
	{11, 1, 1, -1, -1},
	{11, -1, -1, 1, -1},
	{11, -1, -1, -1, -1},
	{11, 1, 1, -1, 1},
	{11, 1, -1, 1, 1},
	{11, -1, 1, 1, 1},
	{11, -1, 1, -1, -1},
	{11, -1, -1, -1, 1},
	{11, 1, -1, -1, -1},
	{11, 1, 1, 1, -1},
}

// Spectrum Huffman Codebook 2
var huffman_02_1 = []hcb_struct_1{
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{1, 0},
	{1, 0},
	{2, 0},
	{3, 0},
	{4, 0},
	{5, 0},
	{6, 0},
	{7, 0},
	{8, 0},
	{9, 1},
	{11, 1},
	{13, 1},
	{15, 1},
	{17, 1},
	{19, 1},
	{21, 1},
	{23, 1},
	{25, 1},
	{27, 1},
	{29, 1},
	{31, 1},
	{33, 2},
	{37, 2},
	{41, 2},
	{45, 3},
	{53, 3},
	{61, 3},
	{69, 4},
}

var huffman_02 = []hcb_struct{
	{3, 0, 0, 0, 0},
	{4, 1, 0, 0, 0},
	{5, -1, 0, 0, 0},
	{5, 0, 0, 0, 1},
	{5, 0, 0, -1, 0},
	{5, 0, 0, 0, -1},
	{5, 0, -1, 0, 0},
	{5, 0, 0, 1, 0},
	{5, 0, 1, 0, 0},
	{6, 0, -1, 1, 0},
	{6, -1, 1, 0, 0},
	{6, 0, 1, -1, 0},
	{6, 0, 0, 1, -1},
	{6, 0, 1, 0, -1},
	{6, 0, 0, -1, 1},
	{6, -1, 0, 0, -1},
	{6, 1, -1, 0, 0},
	{6, 1, 0, -1, 0},
	{6, -1, -1, 0, 0},
	{6, 0, 0, -1, -1},
	{6, 1, 0, 1, 0},
	{6, 1, 0, 0, 1},
	{6, 0, -1, 0, 1},
	{6, -1, 0, 1, 0},
	{6, 0, 1, 0, 1},
	{6, 0, -1, -1, 0},
	{6, -1, 0, 0, 1},
	{6, 0, -1, 0, -1},
	{6, -1, 0, -1, 0},
	{6, 1, 1, 0, 0},
	{6, 0, 1, 1, 0},
	{6, 0, 0, 1, 1},
	{6, 1, 0, 0, -1},
	{7, 0, 1, -1, 1},
	{7, 1, 0, -1, 1},
	{7, -1, 1, -1, 0},
	{7, 0, -1, 1, -1},
	{7, 1, -1, 1, 0},
	{7, 1, 1, 0, -1},
	{7, 1, 0, 1, 1},
	{7, -1, 1, 1, 0},
	{7, 0, -1, -1, 1},
	{7, 1, 1, 1, 0},
	{7, -1, 0, 1, -1},
	{7, -1, -1, -1, 0},
	{7, -1, 0, -1, 1},
	{7, -1, 0, -1, 1},
	{7, 1, -1, -1, 0},
	{7, 1, -1, -1, 0},
	{7, 1, 1, -1, 0},
	{7, 1, 1, -1, 0},
	{8, 1, -1, 0, 1},
	{8, -1, 1, 0, -1},
	{8, -1, -1, 1, 0},
	{8, -1, 0, 1, 1},
	{8, -1, -1, 0, 1},
	{8, -1, -1, 0, -1},
	{8, 0, -1, -1, -1},
	{8, 1, 0, 1, -1},
	{8, 1, 0, -1, -1},
	{8, 0, 1, -1, -1},
	{8, 0, 1, 1, 1},
	{8, -1, 1, 0, 1},
	{8, -1, 0, -1, -1},
	{8, 0, 1, 1, -1},
	{8, 1, -1, 0, -1},
	{8, 0, -1, 1, 1},
	{8, 1, 1, 0, 1},
	{8, 1, -1, 1, -1},
	{8, -1, 1, -1, 1},
	{8, -1, 1, -1, 1},
	{9, 1, -1, -1, 1},
	{9, -1, -1, -1, -1},
	{9, -1, 1, 1, -1},
	{9, -1, 1, 1, 1},
	{9, 1, 1, 1, 1},
	{9, -1, -1, 1, -1},
	{9, 1, -1, 1, 1},
	{9, -1, 1, -1, -1},
	{9, -1, -1, 1, 1},
	{9, 1, 1, -1, -1},
	{9, 1, -1, -1, -1},
	{9, -1, -1, -1, 1},
	{9, 1, 1, -1, 1},
	{9, 1, 1, 1, -1},
}

// Spectrum Huffman Codebook 2
var huffman_03 = []hcb_struct{
	{0, 1, 2},
	{1, 0, 0},
	{0, 1, 2},
	{0, 2, 3},
	{0, 3, 4},
	{0, 4, 5},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{1, 1, 0},
	{1, 0, 0, 0, 1},
	{1, 0, 1, 0, 0},
	{1, 0, 0, 1, 0},
	{0, 4, 5},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{1, 1, 1},
	{1, 0, 0, 1, 1},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{1, 0, 1, 1, 0},
	{1, 0, 1, 0, 1},
	{1, 1, 0, 1, 0},
	{1, 0, 1, 1, 1},
	{1, 1, 0, 0, 1},
	{1, 1, 1, 1, 0},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{1, 1, 1, 1, 1},
	{1, 1, 0, 1, 1},
	{1, 1, 1, 0, 1},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{1, 2, 0, 0, 0},
	{1, 0, 0, 0, 2},
	{1, 0, 0, 1, 2},
	{1, 2, 1, 0, 0},
	{1, 1, 2, 1, 0},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{0, 24, 25},
	{0, 25, 26},
	{1, 0, 0, 2, 1},
	{1, 0, 1, 2, 1},
	{1, 1, 2, 0, 0},
	{1, 0, 1, 1, 2},
	{1, 2, 1, 1, 0},
	{1, 0, 0, 2, 0},
	{1, 0, 2, 1, 0},
	{1, 0, 1, 2, 0},
	{1, 0, 2, 0, 0},
	{1, 0, 1, 0, 2},
	{1, 2, 0, 1, 0},
	{1, 1, 2, 1, 1},
	{1, 0, 2, 1, 1},
	{1, 1, 1, 2, 0},
	{1, 1, 1, 2, 1},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{1, 1, 2, 0, 1},
	{1, 1, 0, 2, 0},
	{1, 1, 0, 2, 1},
	{1, 0, 2, 0, 1},
	{1, 2, 1, 1, 1},
	{1, 1, 1, 1, 2},
	{1, 2, 1, 0, 1},
	{1, 1, 0, 1, 2},
	{1, 0, 0, 2, 2},
	{1, 0, 1, 2, 2},
	{1, 2, 2, 1, 0},
	{1, 1, 2, 2, 0},
	{1, 1, 0, 0, 2},
	{1, 2, 0, 0, 1},
	{1, 0, 2, 2, 1},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{1, 2, 2, 0, 0},
	{1, 1, 2, 2, 1},
	{1, 1, 1, 0, 2},
	{1, 2, 0, 1, 1},
	{1, 1, 1, 2, 2},
	{1, 2, 2, 1, 1},
	{1, 0, 2, 2, 0},
	{1, 0, 2, 1, 2},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{1, 1, 0, 2, 2},
	{1, 2, 2, 0, 1},
	{1, 2, 1, 2, 0},
	{1, 2, 2, 2, 0},
	{1, 0, 2, 2, 2},
	{1, 2, 2, 2, 1},
	{1, 2, 1, 2, 1},
	{1, 1, 2, 1, 2},
	{1, 1, 2, 2, 2},
	{0, 3, 4},
	{0, 4, 5},
	{0, 5, 6},
	{1, 0, 2, 0, 2},
	{1, 2, 0, 2, 0},
	{1, 1, 2, 0, 2},
	{0, 3, 4},
	{0, 4, 5},
	{0, 5, 6},
	{1, 2, 0, 2, 1},
	{1, 2, 1, 1, 2},
	{1, 2, 1, 0, 2},
	{0, 3, 4},
	{0, 4, 5},
	{0, 5, 6},
	{1, 2, 2, 2, 2},
	{1, 2, 2, 1, 2},
	{1, 2, 1, 2, 2},
	{1, 2, 0, 1, 2},
	{1, 2, 0, 0, 2},
	{0, 1, 2},
	{1, 2, 2, 0, 2},
	{1, 2, 0, 2, 2},
}

// Spectrum Huffman Codebook 4
var huffman_04_1 = []hcb_struct_1{
	{0, 0},
	{0, 0},
	{1, 0},
	{1, 0},
	{2, 0},
	{2, 0},
	{3, 0},
	{3, 0},
	{4, 0},
	{4, 0},
	{5, 0},
	{5, 0},
	{6, 0},
	{6, 0},
	{7, 0},
	{7, 0},
	{8, 0},
	{8, 0},
	{9, 0},
	{9, 0},
	{10, 0},
	{11, 0},
	{12, 0},
	{13, 0},
	{14, 0},
	{15, 0},
	{16, 2},
	{20, 2},
	{24, 3},
	{32, 3},
	{40, 4},
	{56, 7},
}

var huffman_04 = []hcb_struct{
	{4, 1, 1, 1, 1},
	{4, 0, 1, 1, 1},
	{4, 1, 1, 0, 1},
	{4, 1, 1, 1, 0},
	{4, 1, 0, 1, 1},
	{4, 1, 0, 0, 0},
	{4, 1, 1, 0, 0},
	{4, 0, 0, 0, 0},
	{4, 0, 0, 1, 1},
	{4, 1, 0, 1, 0},
	{5, 1, 0, 0, 1},
	{5, 0, 1, 1, 0},
	{5, 0, 0, 0, 1},
	{5, 0, 1, 0, 1},
	{5, 0, 0, 1, 0},
	{5, 0, 1, 0, 0},
	{7, 2, 1, 1, 1},
	{7, 1, 1, 2, 1},
	{7, 1, 2, 1, 1},
	{7, 1, 1, 1, 2},
	{7, 2, 1, 1, 0},
	{7, 2, 1, 0, 1},
	{7, 1, 2, 1, 0},
	{7, 2, 0, 1, 1},
	{7, 0, 1, 2, 1},
	{7, 0, 1, 2, 1},
	{8, 0, 1, 1, 2},
	{8, 1, 1, 2, 0},
	{8, 0, 2, 1, 1},
	{8, 1, 0, 1, 2},
	{8, 1, 2, 0, 1},
	{8, 1, 1, 0, 2},
	{8, 1, 0, 2, 1},
	{8, 2, 1, 0, 0},
	{8, 2, 0, 1, 0},
	{8, 1, 2, 0, 0},
	{8, 2, 0, 0, 1},
	{8, 0, 1, 0, 2},
	{8, 0, 2, 1, 0},
	{8, 0, 0, 1, 2},
	{8, 0, 1, 2, 0},
	{8, 0, 1, 2, 0},
	{8, 0, 2, 0, 1},
	{8, 0, 2, 0, 1},
	{8, 1, 0, 0, 2},
	{8, 1, 0, 0, 2},
	{8, 0, 0, 2, 1},
	{8, 0, 0, 2, 1},
	{8, 1, 0, 2, 0},
	{8, 1, 0, 2, 0},
	{8, 2, 0, 0, 0},
	{8, 2, 0, 0, 0},
	{8, 0, 0, 0, 2},
	{8, 0, 0, 0, 2},
	{9, 0, 2, 0, 0},
	{9, 0, 0, 2, 0},
	{9, 1, 2, 2, 1},
	{9, 1, 2, 2, 1},
	{9, 1, 2, 2, 1},
	{9, 1, 2, 2, 1},
	{9, 1, 2, 2, 1},
	{9, 1, 2, 2, 1},
	{9, 1, 2, 2, 1},
	{9, 1, 2, 2, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 2, 1, 1},
	{9, 2, 1, 2, 1},
	{9, 2, 1, 2, 1},
	{9, 2, 1, 2, 1},
	{9, 2, 1, 2, 1},
	{9, 2, 1, 2, 1},
	{9, 2, 1, 2, 1},
	{9, 2, 1, 2, 1},
	{9, 2, 1, 2, 1},
	{9, 1, 1, 2, 2},
	{9, 1, 1, 2, 2},
	{9, 1, 1, 2, 2},
	{9, 1, 1, 2, 2},
	{9, 1, 1, 2, 2},
	{9, 1, 1, 2, 2},
	{9, 1, 1, 2, 2},
	{9, 1, 1, 2, 2},
	{9, 1, 2, 1, 2},
	{9, 1, 2, 1, 2},
	{9, 1, 2, 1, 2},
	{9, 1, 2, 1, 2},
	{9, 1, 2, 1, 2},
	{9, 1, 2, 1, 2},
	{9, 1, 2, 1, 2},
	{9, 1, 2, 1, 2},
	{9, 2, 1, 1, 2},
	{9, 2, 1, 1, 2},
	{9, 2, 1, 1, 2},
	{9, 2, 1, 1, 2},
	{9, 2, 1, 1, 2},
	{9, 2, 1, 1, 2},
	{9, 2, 1, 1, 2},
	{9, 2, 1, 1, 2},
	{10, 1, 2, 2, 0},
	{10, 1, 2, 2, 0},
	{10, 1, 2, 2, 0},
	{10, 1, 2, 2, 0},
	{10, 2, 2, 1, 0},
	{10, 2, 2, 1, 0},
	{10, 2, 2, 1, 0},
	{10, 2, 2, 1, 0},
	{10, 2, 1, 2, 0},
	{10, 2, 1, 2, 0},
	{10, 2, 1, 2, 0},
	{10, 2, 1, 2, 0},
	{10, 0, 2, 2, 1},
	{10, 0, 2, 2, 1},
	{10, 0, 2, 2, 1},
	{10, 0, 2, 2, 1},
	{10, 0, 1, 2, 2},
	{10, 0, 1, 2, 2},
	{10, 0, 1, 2, 2},
	{10, 0, 1, 2, 2},
	{10, 2, 2, 0, 1},
	{10, 2, 2, 0, 1},
	{10, 2, 2, 0, 1},
	{10, 2, 2, 0, 1},
	{10, 0, 2, 1, 2},
	{10, 0, 2, 1, 2},
	{10, 0, 2, 1, 2},
	{10, 0, 2, 1, 2},
	{10, 2, 0, 2, 1},
	{10, 2, 0, 2, 1},
	{10, 2, 0, 2, 1},
	{10, 2, 0, 2, 1},
	{10, 1, 0, 2, 2},
	{10, 1, 0, 2, 2},
	{10, 1, 0, 2, 2},
	{10, 1, 0, 2, 2},
	{10, 2, 2, 2, 1},
	{10, 2, 2, 2, 1},
	{10, 2, 2, 2, 1},
	{10, 2, 2, 2, 1},
	{10, 1, 2, 0, 2},
	{10, 1, 2, 0, 2},
	{10, 1, 2, 0, 2},
	{10, 1, 2, 0, 2},
	{10, 2, 0, 1, 2},
	{10, 2, 0, 1, 2},
	{10, 2, 0, 1, 2},
	{10, 2, 0, 1, 2},
	{10, 2, 1, 0, 2},
	{10, 2, 1, 0, 2},
	{10, 2, 1, 0, 2},
	{10, 2, 1, 0, 2},
	{10, 1, 2, 2, 2},
	{10, 1, 2, 2, 2},
	{10, 1, 2, 2, 2},
	{10, 1, 2, 2, 2},
	{11, 2, 1, 2, 2},
	{11, 2, 1, 2, 2},
	{11, 2, 2, 1, 2},
	{11, 2, 2, 1, 2},
	{11, 0, 2, 2, 0},
	{11, 0, 2, 2, 0},
	{11, 2, 2, 0, 0},
	{11, 2, 2, 0, 0},
	{11, 0, 0, 2, 2},
	{11, 0, 0, 2, 2},
	{11, 2, 0, 2, 0},
	{11, 2, 0, 2, 0},
	{11, 0, 2, 0, 2},
	{11, 0, 2, 0, 2},
	{11, 2, 0, 0, 2},
	{11, 2, 0, 0, 2},
	{11, 2, 2, 2, 2},
	{11, 2, 2, 2, 2},
	{11, 0, 2, 2, 2},
	{11, 0, 2, 2, 2},
	{11, 2, 2, 2, 0},
	{11, 2, 2, 2, 0},
	{12, 2, 2, 0, 2},
	{12, 2, 0, 2, 2},
}

// Spectrum Huffman Codebook 5
var huffman_05 = []hcb_struct{
	{0, 1, 2},
	{1, 0, 0},
	{0, 1, 2},
	{0, 2, 3},
	{0, 3, 4},
	{0, 4, 5},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{1, -1, 0},
	{1, 1, 0},
	{1, 0, 1},
	{1, 0, -1},
	{0, 4, 5},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{1, 1, -1},
	{1, -1, 1},
	{1, -1, -1},
	{1, 1, 1},
	{0, 4, 5},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{1, -2, 0},
	{1, 0, 2},
	{1, 2, 0},
	{1, 0, -2},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{1, -2, -1},
	{1, 2, 1},
	{1, -1, -2},
	{1, 1, 2},
	{1, -2, 1},
	{1, 2, -1},
	{1, -1, 2},
	{1, 1, -2},
	{1, -3, 0},
	{1, 3, 0},
	{1, 0, -3},
	{1, 0, 3},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{1, -3, -1},
	{1, 1, 3},
	{1, 3, 1},
	{1, -1, -3},
	{1, -3, 1},
	{1, 3, -1},
	{1, 1, -3},
	{1, -1, 3},
	{1, -2, 2},
	{1, 2, 2},
	{1, -2, -2},
	{1, 2, -2},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{1, -3, -2},
	{1, 3, -2},
	{1, -2, 3},
	{1, 2, -3},
	{1, 3, 2},
	{1, 2, 3},
	{1, -3, 2},
	{1, -2, -3},
	{1, 0, -4},
	{1, -4, 0},
	{1, 4, 1},
	{1, 4, 0},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{1, -4, -1},
	{1, 0, 4},
	{1, 4, -1},
	{1, -1, -4},
	{1, 1, 4},
	{1, -1, 4},
	{1, -4, 1},
	{1, 1, -4},
	{1, 3, -3},
	{1, -3, -3},
	{1, -3, 3},
	{1, -2, 4},
	{1, -4, -2},
	{1, 4, 2},
	{1, 2, -4},
	{1, 2, 4},
	{1, 3, 3},
	{1, -4, 2},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{1, -2, -4},
	{1, 4, -2},
	{1, 3, -4},
	{1, -4, -3},
	{1, -4, 3},
	{1, 3, 4},
	{1, -3, 4},
	{1, 4, 3},
	{1, 4, -3},
	{1, -3, -4},
	{0, 2, 3},
	{0, 3, 4},
	{1, 4, -4},
	{1, -4, 4},
	{1, 4, 4},
	{1, -4, -4},
}

// Spectrum Huffman Codebook 6
var huffman_06_1 = []hcb_struct_1{
	{0, 0},
	{0, 0},
	{1, 0},
	{1, 0},
	{2, 0},
	{2, 0},
	{3, 0},
	{3, 0},
	{4, 0},
	{4, 0},
	{5, 0},
	{5, 0},
	{6, 0},
	{6, 0},
	{7, 0},
	{7, 0},
	{8, 0},
	{8, 0},
	{9, 1},
	{11, 1},
	{13, 1},
	{15, 1},
	{17, 1},
	{19, 1},
	{21, 1},
	{23, 1},
	{25, 2},
	{29, 2},
	{33, 2},
	{37, 3},
	{45, 4},
	{61, 6},
}

var huffman_06 = []hcb_struct{
	{4, 0, 0},
	{4, 1, 0},
	{4, 0, -1},
	{4, 0, 1},
	{4, -1, 0},
	{4, 1, 1},
	{4, -1, 1},
	{4, 1, -1},
	{4, -1, -1},
	{6, 2, -1},
	{6, 2, 1},
	{6, -2, 1},
	{6, -2, -1},
	{6, -2, 0},
	{6, -1, 2},
	{6, 2, 0},
	{6, 1, -2},
	{6, 1, 2},
	{6, 0, -2},
	{6, -1, -2},
	{6, 0, 2},
	{6, 2, -2},
	{6, -2, 2},
	{6, -2, -2},
	{6, 2, 2},
	{7, -3, 1},
	{7, 3, 1},
	{7, 3, -1},
	{7, -1, 3},
	{7, -3, -1},
	{7, 1, 3},
	{7, 1, -3},
	{7, -1, -3},
	{7, 3, 0},
	{7, -3, 0},
	{7, 0, -3},
	{7, 0, 3},
	{7, 3, 2},
	{7, 3, 2},
	{8, -3, -2},
	{8, -2, 3},
	{8, 2, 3},
	{8, 3, -2},
	{8, 2, -3},
	{8, -2, -3},
	{8, -3, 2},
	{8, -3, 2},
	{8, 3, 3},
	{8, 3, 3},
	{9, 3, -3},
	{9, -3, -3},
	{9, -3, 3},
	{9, 1, -4},
	{9, -1, -4},
	{9, 4, 1},
	{9, -4, 1},
	{9, -4, -1},
	{9, 1, 4},
	{9, 4, -1},
	{9, -1, 4},
	{9, 0, -4},
	{9, -4, 2},
	{9, -4, 2},
	{9, -4, 2},
	{9, -4, 2},
	{9, -4, -2},
	{9, -4, -2},
	{9, -4, -2},
	{9, -4, -2},
	{9, 2, 4},
	{9, 2, 4},
	{9, 2, 4},
	{9, 2, 4},
	{9, -2, -4},
	{9, -2, -4},
	{9, -2, -4},
	{9, -2, -4},
	{9, -4, 0},
	{9, -4, 0},
	{9, -4, 0},
	{9, -4, 0},
	{9, 4, 2},
	{9, 4, 2},
	{9, 4, 2},
	{9, 4, 2},
	{9, 4, -2},
	{9, 4, -2},
	{9, 4, -2},
	{9, 4, -2},
	{9, -2, 4},
	{9, -2, 4},
	{9, -2, 4},
	{9, -2, 4},
	{9, 4, 0},
	{9, 4, 0},
	{9, 4, 0},
	{9, 4, 0},
	{9, 2, -4},
	{9, 2, -4},
	{9, 2, -4},
	{9, 2, -4},
	{9, 0, 4},
	{9, 0, 4},
	{9, 0, 4},
	{9, 0, 4},
	{10, -3, -4},
	{10, -3, -4},
	{10, -3, 4},
	{10, -3, 4},
	{10, 3, -4},
	{10, 3, -4},
	{10, 4, -3},
	{10, 4, -3},
	{10, 3, 4},
	{10, 3, 4},
	{10, 4, 3},
	{10, 4, 3},
	{10, -4, 3},
	{10, -4, 3},
	{10, -4, -3},
	{10, -4, -3},
	{11, 4, 4},
	{11, -4, 4},
	{11, -4, -4},
	{11, 4, -4},
}

// Spectrum Huffman Codebook 7
var huffman_07 = []hcb_struct{
	{0, 1, 2},
	{1, 0, 0},
	{0, 1, 2},
	{0, 2, 3},
	{0, 3, 4},
	{1, 1, 0},
	{1, 0, 1},
	{0, 2, 3},
	{0, 3, 4},
	{1, 1, 1},
	{0, 3, 4},
	{0, 4, 5},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{1, 2, 1},
	{1, 1, 2},
	{1, 2, 0},
	{1, 0, 2},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{1, 3, 1},
	{1, 1, 3},
	{1, 2, 2},
	{1, 3, 0},
	{1, 0, 3},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{1, 2, 3},
	{1, 3, 2},
	{1, 1, 4},
	{1, 4, 1},
	{1, 1, 5},
	{1, 5, 1},
	{1, 3, 3},
	{1, 2, 4},
	{1, 0, 4},
	{1, 4, 0},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{1, 4, 2},
	{1, 2, 5},
	{1, 5, 2},
	{1, 0, 5},
	{1, 6, 1},
	{1, 5, 0},
	{1, 1, 6},
	{1, 4, 3},
	{1, 3, 5},
	{1, 3, 4},
	{1, 5, 3},
	{1, 2, 6},
	{1, 6, 2},
	{1, 1, 7},
	{0, 10, 11},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{1, 3, 6},
	{1, 0, 6},
	{1, 6, 0},
	{1, 4, 4},
	{1, 7, 1},
	{1, 4, 5},
	{1, 7, 2},
	{1, 5, 4},
	{1, 6, 3},
	{1, 2, 7},
	{1, 7, 3},
	{1, 6, 4},
	{1, 5, 5},
	{1, 4, 6},
	{1, 3, 7},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{1, 7, 0},
	{1, 0, 7},
	{1, 6, 5},
	{1, 5, 6},
	{1, 7, 4},
	{1, 4, 7},
	{1, 5, 7},
	{1, 7, 5},
	{0, 2, 3},
	{0, 3, 4},
	{1, 7, 6},
	{1, 6, 6},
	{1, 6, 7},
	{1, 7, 7},
}

// Spectrum Huffman Codebook 8
var huffman_08_1 = []hcb_struct_1{
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{1, 0},
	{1, 0},
	{2, 0},
	{2, 0},
	{3, 0},
	{3, 0},
	{4, 0},
	{4, 0},
	{5, 0},
	{5, 0},
	{6, 0},
	{7, 0},
	{8, 0},
	{9, 0},
	{10, 0},
	{11, 0},
	{12, 0},
	{13, 1},
	{15, 1},
	{17, 1},
	{19, 1},
	{21, 1},
	{23, 2},
	{27, 2},
	{31, 2},
	{35, 3},
	{43, 3},
	{51, 5},
}

var huffman_08 = []hcb_struct{
	{3, 1, 1},
	{4, 2, 1},
	{4, 1, 0},
	{4, 1, 2},
	{4, 0, 1},
	{4, 2, 2},
	{5, 0, 0},
	{5, 2, 0},
	{5, 0, 2},
	{5, 3, 1},
	{5, 1, 3},
	{5, 3, 2},
	{5, 2, 3},
	{6, 3, 3},
	{6, 4, 1},
	{6, 1, 4},
	{6, 4, 2},
	{6, 2, 4},
	{6, 3, 0},
	{6, 0, 3},
	{6, 4, 3},
	{6, 3, 4},
	{6, 5, 2},
	{7, 5, 1},
	{7, 2, 5},
	{7, 1, 5},
	{7, 5, 3},
	{7, 3, 5},
	{7, 4, 4},
	{7, 5, 4},
	{7, 0, 4},
	{7, 4, 5},
	{7, 4, 0},
	{7, 2, 6},
	{7, 6, 2},
	{7, 6, 1},
	{7, 6, 1},
	{7, 1, 6},
	{7, 1, 6},
	{8, 3, 6},
	{8, 6, 3},
	{8, 5, 5},
	{8, 5, 0},
	{8, 6, 4},
	{8, 0, 5},
	{8, 4, 6},
	{8, 7, 1},
	{8, 7, 2},
	{8, 2, 7},
	{8, 6, 5},
	{8, 7, 3},
	{8, 1, 7},
	{8, 1, 7},
	{8, 1, 7},
	{8, 1, 7},
	{8, 5, 6},
	{8, 5, 6},
	{8, 5, 6},
	{8, 5, 6},
	{8, 3, 7},
	{8, 3, 7},
	{8, 3, 7},
	{8, 3, 7},
	{9, 6, 6},
	{9, 6, 6},
	{9, 7, 4},
	{9, 7, 4},
	{9, 6, 0},
	{9, 6, 0},
	{9, 4, 7},
	{9, 4, 7},
	{9, 0, 6},
	{9, 0, 6},
	{9, 7, 5},
	{9, 7, 5},
	{9, 7, 6},
	{9, 7, 6},
	{9, 6, 7},
	{9, 6, 7},
	{10, 5, 7},
	{10, 7, 0},
	{10, 0, 7},
	{10, 7, 7},
}

// Spectrum Huffman Codebook 9
var huffman_09 = []hcb_struct{
	{0, 1, 2},
	{1, 0, 0},
	{0, 1, 2},
	{0, 2, 3},
	{0, 3, 4},
	{1, 1, 0},
	{1, 0, 1},
	{0, 2, 3},
	{0, 3, 4},
	{1, 1, 1},
	{0, 3, 4},
	{0, 4, 5},
	{0, 5, 6},
	{0, 6, 7},
	{0, 7, 8},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{1, 2, 1},
	{1, 1, 2},
	{1, 2, 0},
	{1, 0, 2},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{1, 3, 1},
	{1, 2, 2},
	{1, 1, 3},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{0, 16, 17},
	{0, 17, 18},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{0, 24, 25},
	{0, 25, 26},
	{1, 3, 0},
	{1, 0, 3},
	{1, 2, 3},
	{1, 3, 2},
	{1, 1, 4},
	{1, 4, 1},
	{1, 2, 4},
	{1, 1, 5},
	{0, 18, 19},
	{0, 19, 20},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{0, 24, 25},
	{0, 25, 26},
	{0, 26, 27},
	{0, 27, 28},
	{0, 28, 29},
	{0, 29, 30},
	{0, 30, 31},
	{0, 31, 32},
	{0, 32, 33},
	{0, 33, 34},
	{0, 34, 35},
	{0, 35, 36},
	{1, 4, 2},
	{1, 3, 3},
	{1, 0, 4},
	{1, 4, 0},
	{1, 5, 1},
	{1, 2, 5},
	{1, 1, 6},
	{1, 3, 4},
	{1, 5, 2},
	{1, 6, 1},
	{1, 4, 3},
	{0, 25, 26},
	{0, 26, 27},
	{0, 27, 28},
	{0, 28, 29},
	{0, 29, 30},
	{0, 30, 31},
	{0, 31, 32},
	{0, 32, 33},
	{0, 33, 34},
	{0, 34, 35},
	{0, 35, 36},
	{0, 36, 37},
	{0, 37, 38},
	{0, 38, 39},
	{0, 39, 40},
	{0, 40, 41},
	{0, 41, 42},
	{0, 42, 43},
	{0, 43, 44},
	{0, 44, 45},
	{0, 45, 46},
	{0, 46, 47},
	{0, 47, 48},
	{0, 48, 49},
	{0, 49, 50},
	{1, 0, 5},
	{1, 2, 6},
	{1, 5, 0},
	{1, 1, 7},
	{1, 3, 5},
	{1, 1, 8},
	{1, 8, 1},
	{1, 4, 4},
	{1, 5, 3},
	{1, 6, 2},
	{1, 7, 1},
	{1, 0, 6},
	{1, 8, 2},
	{1, 2, 8},
	{1, 3, 6},
	{1, 2, 7},
	{1, 4, 5},
	{1, 9, 1},
	{1, 1, 9},
	{1, 7, 2},
	{0, 30, 31},
	{0, 31, 32},
	{0, 32, 33},
	{0, 33, 34},
	{0, 34, 35},
	{0, 35, 36},
	{0, 36, 37},
	{0, 37, 38},
	{0, 38, 39},
	{0, 39, 40},
	{0, 40, 41},
	{0, 41, 42},
	{0, 42, 43},
	{0, 43, 44},
	{0, 44, 45},
	{0, 45, 46},
	{0, 46, 47},
	{0, 47, 48},
	{0, 48, 49},
	{0, 49, 50},
	{0, 50, 51},
	{0, 51, 52},
	{0, 52, 53},
	{0, 53, 54},
	{0, 54, 55},
	{0, 55, 56},
	{0, 56, 57},
	{0, 57, 58},
	{0, 58, 59},
	{0, 59, 60},
	{1, 6, 0},
	{1, 5, 4},
	{1, 6, 3},
	{1, 8, 3},
	{1, 0, 7},
	{1, 9, 2},
	{1, 3, 8},
	{1, 4, 6},
	{1, 3, 7},
	{1, 0, 8},
	{1, 10, 1},
	{1, 6, 4},
	{1, 2, 9},
	{1, 5, 5},
	{1, 8, 0},
	{1, 7, 0},
	{1, 7, 3},
	{1, 10, 2},
	{1, 9, 3},
	{1, 8, 4},
	{1, 1, 10},
	{1, 7, 4},
	{1, 6, 5},
	{1, 5, 6},
	{1, 4, 8},
	{1, 4, 7},
	{1, 3, 9},
	{1, 11, 1},
	{1, 5, 8},
	{1, 9, 0},
	{1, 8, 5},
	{0, 29, 30},
	{0, 30, 31},
	{0, 31, 32},
	{0, 32, 33},
	{0, 33, 34},
	{0, 34, 35},
	{0, 35, 36},
	{0, 36, 37},
	{0, 37, 38},
	{0, 38, 39},
	{0, 39, 40},
	{0, 40, 41},
	{0, 41, 42},
	{0, 42, 43},
	{0, 43, 44},
	{0, 44, 45},
	{0, 45, 46},
	{0, 46, 47},
	{0, 47, 48},
	{0, 48, 49},
	{0, 49, 50},
	{0, 50, 51},
	{0, 51, 52},
	{0, 52, 53},
	{0, 53, 54},
	{0, 54, 55},
	{0, 55, 56},
	{0, 56, 57},
	{0, 57, 58},
	{1, 10, 3},
	{1, 2, 10},
	{1, 0, 9},
	{1, 11, 2},
	{1, 9, 4},
	{1, 6, 6},
	{1, 12, 1},
	{1, 4, 9},
	{1, 8, 6},
	{1, 1, 11},
	{1, 9, 5},
	{1, 10, 4},
	{1, 5, 7},
	{1, 7, 5},
	{1, 2, 11},
	{1, 1, 12},
	{1, 12, 2},
	{1, 11, 3},
	{1, 3, 10},
	{1, 5, 9},
	{1, 6, 7},
	{1, 8, 7},
	{1, 11, 4},
	{1, 0, 10},
	{1, 7, 6},
	{1, 12, 3},
	{1, 10, 0},
	{1, 10, 5},
	{1, 4, 10},
	{1, 6, 8},
	{1, 2, 12},
	{1, 9, 6},
	{1, 9, 7},
	{1, 4, 11},
	{1, 11, 0},
	{1, 6, 9},
	{1, 3, 11},
	{1, 5, 10},
	{0, 20, 21},
	{0, 21, 22},
	{0, 22, 23},
	{0, 23, 24},
	{0, 24, 25},
	{0, 25, 26},
	{0, 26, 27},
	{0, 27, 28},
	{0, 28, 29},
	{0, 29, 30},
	{0, 30, 31},
	{0, 31, 32},
	{0, 32, 33},
	{0, 33, 34},
	{0, 34, 35},
	{0, 35, 36},
	{0, 36, 37},
	{0, 37, 38},
	{0, 38, 39},
	{0, 39, 40},
	{1, 8, 8},
	{1, 7, 8},
	{1, 12, 5},
	{1, 3, 12},
	{1, 11, 5},
	{1, 7, 7},
	{1, 12, 4},
	{1, 11, 6},
	{1, 10, 6},
	{1, 4, 12},
	{1, 7, 9},
	{1, 5, 11},
	{1, 0, 11},
	{1, 12, 6},
	{1, 6, 10},
	{1, 12, 0},
	{1, 10, 7},
	{1, 5, 12},
	{1, 7, 10},
	{1, 9, 8},
	{1, 0, 12},
	{1, 11, 7},
	{1, 8, 9},
	{1, 9, 9},
	{1, 10, 8},
	{1, 7, 11},
	{1, 12, 7},
	{1, 6, 11},
	{1, 8, 11},
	{1, 11, 8},
	{1, 7, 12},
	{1, 6, 12},
	{0, 8, 9},
	{0, 9, 10},
	{0, 10, 11},
	{0, 11, 12},
	{0, 12, 13},
	{0, 13, 14},
	{0, 14, 15},
	{0, 15, 16},
	{1, 8, 10},
	{1, 10, 9},
	{1, 8, 12},
	{1, 9, 10},
	{1, 9, 11},
	{1, 9, 12},
	{1, 10, 11},
	{1, 12, 9},
	{1, 10, 10},
	{1, 11, 9},
	{1, 12, 8},
	{1, 11, 10},
	{1, 12, 10},
	{1, 12, 11},
	{0, 2, 3},
	{0, 3, 4},
	{1, 10, 12},
	{1, 11, 11},
	{1, 11, 12},
	{1, 12, 12},
}

// Spectrum Huffman Codebook 10
var huffman_10_1 = []hcb_struct_1{
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{1, 0},
	{1, 0},
	{1, 0},
	{1, 0},
	{2, 0},
	{2, 0},
	{2, 0},
	{2, 0},
	{3, 0},
	{3, 0},
	{4, 0},
	{4, 0},
	{5, 0},
	{5, 0},
	{6, 0},
	{6, 0},
	{7, 0},
	{7, 0},
	{8, 0},
	{8, 0},
	{9, 0},
	{9, 0},
	{10, 0},
	{10, 0},
	{11, 0},
	{12, 0},
	{13, 0},
	{14, 0},
	{15, 0},
	{16, 0},
	{17, 0},
	{18, 0},
	{19, 0},
	{20, 0},
	{21, 0},
	{22, 0},
	{23, 0},
	{24, 0},
	{25, 1},
	{27, 1},
	{29, 1},
	{31, 1},
	{33, 1},
	{35, 1},
	{37, 1},
	{39, 1},
	{41, 2},
	{45, 2},
	{49, 2},
	{53, 2},
	{57, 2},
	{61, 2},
	{65, 3},
	{73, 3},
	{81, 3},
	{89, 3},
	{97, 4},
	{113, 4},
	{129, 4},
	{145, 6},
}

var huffman_10 = []hcb_struct{
	{4, 1, 1},
	{4, 1, 2},
	{4, 2, 1},
	{5, 2, 2},
	{5, 1, 0},
	{5, 0, 1},
	{5, 1, 3},
	{5, 3, 2},
	{5, 3, 1},
	{5, 2, 3},
	{5, 3, 3},
	{6, 2, 0},
	{6, 0, 2},
	{6, 2, 4},
	{6, 4, 2},
	{6, 1, 4},
	{6, 4, 1},
	{6, 0, 0},
	{6, 4, 3},
	{6, 3, 4},
	{6, 3, 0},
	{6, 0, 3},
	{6, 4, 4},
	{6, 2, 5},
	{6, 5, 2},
	{7, 1, 5},
	{7, 5, 1},
	{7, 5, 3},
	{7, 3, 5},
	{7, 5, 4},
	{7, 4, 5},
	{7, 6, 2},
	{7, 2, 6},
	{7, 6, 3},
	{7, 4, 0},
	{7, 6, 1},
	{7, 0, 4},
	{7, 1, 6},
	{7, 3, 6},
	{7, 5, 5},
	{7, 6, 4},
	{7, 4, 6},
	{7, 4, 6},
	{8, 6, 5},
	{8, 7, 2},
	{8, 3, 7},
	{8, 2, 7},
	{8, 5, 6},
	{8, 8, 2},
	{8, 7, 3},
	{8, 5, 0},
	{8, 7, 1},
	{8, 0, 5},
	{8, 8, 1},
	{8, 1, 7},
	{8, 8, 3},
	{8, 7, 4},
	{8, 4, 7},
	{8, 2, 8},
	{8, 6, 6},
	{8, 7, 5},
	{8, 1, 8},
	{8, 3, 8},
	{8, 8, 4},
	{8, 4, 8},
	{8, 5, 7},
	{8, 5, 7},
	{8, 8, 5},
	{8, 8, 5},
	{8, 5, 8},
	{8, 5, 8},
	{9, 7, 6},
	{9, 6, 7},
	{9, 9, 2},
	{9, 6, 0},
	{9, 6, 8},
	{9, 9, 3},
	{9, 3, 9},
	{9, 9, 1},
	{9, 2, 9},
	{9, 0, 6},
	{9, 8, 6},
	{9, 9, 4},
	{9, 4, 9},
	{9, 10, 2},
	{9, 1, 9},
	{9, 7, 7},
	{9, 8, 7},
	{9, 9, 5},
	{9, 7, 8},
	{9, 10, 3},
	{9, 5, 9},
	{9, 10, 4},
	{9, 2, 10},
	{9, 10, 1},
	{9, 3, 10},
	{9, 9, 6},
	{9, 6, 9},
	{9, 6, 9},
	{9, 8, 0},
	{9, 8, 0},
	{9, 4, 10},
	{9, 4, 10},
	{9, 7, 0},
	{9, 7, 0},
	{9, 11, 2},
	{9, 11, 2},
	{10, 7, 9},
	{10, 11, 3},
	{10, 10, 6},
	{10, 1, 10},
	{10, 11, 1},
	{10, 9, 7},
	{10, 0, 7},
	{10, 8, 8},
	{10, 10, 5},
	{10, 3, 11},
	{10, 5, 10},
	{10, 8, 9},
	{10, 11, 5},
	{10, 0, 8},
	{10, 11, 4},
	{10, 2, 11},
	{10, 7, 10},
	{10, 6, 10},
	{10, 10, 7},
	{10, 4, 11},
	{10, 1, 11},
	{10, 12, 2},
	{10, 9, 8},
	{10, 12, 3},
	{10, 11, 6},
	{10, 5, 11},
	{10, 12, 4},
	{10, 11, 7},
	{10, 12, 5},
	{10, 3, 12},
	{10, 6, 11},
	{10, 9, 0},
	{10, 10, 8},
	{10, 10, 0},
	{10, 12, 1},
	{10, 0, 9},
	{10, 4, 12},
	{10, 9, 9},
	{10, 12, 6},
	{10, 12, 6},
	{10, 12, 6},
	{10, 12, 6},
	{10, 2, 12},
	{10, 2, 12},
	{10, 2, 12},
	{10, 2, 12},
	{10, 8, 10},
	{10, 8, 10},
	{10, 8, 10},
	{10, 8, 10},
	{11, 9, 10},
	{11, 9, 10},
	{11, 1, 12},
	{11, 1, 12},
	{11, 11, 8},
	{11, 11, 8},
	{11, 12, 7},
	{11, 12, 7},
	{11, 7, 11},
	{11, 7, 11},
	{11, 5, 12},
	{11, 5, 12},
	{11, 6, 12},
	{11, 6, 12},
	{11, 10, 9},
	{11, 10, 9},
	{11, 8, 11},
	{11, 8, 11},
	{11, 12, 8},
	{11, 12, 8},
	{11, 0, 10},
	{11, 0, 10},
	{11, 7, 12},
	{11, 7, 12},
	{11, 11, 0},
	{11, 11, 0},
	{11, 10, 10},
	{11, 10, 10},
	{11, 11, 9},
	{11, 11, 9},
	{11, 11, 10},
	{11, 11, 10},
	{11, 0, 11},
	{11, 0, 11},
	{11, 11, 11},
	{11, 11, 11},
	{11, 9, 11},
	{11, 9, 11},
	{11, 10, 11},
	{11, 10, 11},
	{11, 12, 0},
	{11, 12, 0},
	{11, 8, 12},
	{11, 8, 12},
	{12, 12, 9},
	{12, 10, 12},
	{12, 9, 12},
	{12, 11, 12},
	{12, 12, 11},
	{12, 0, 12},
	{12, 12, 10},
	{12, 12, 12},
}

// Spectrum Huffman Codebook 11
var huffman_11_1 = []hcb_struct_1{
	{0, 0},
	{0, 0},
	{1, 0},
	{1, 0},
	{2, 0},
	{3, 0},
	{4, 0},
	{5, 0},
	{6, 0},
	{7, 0},
	{8, 1},
	{10, 1},
	{12, 1},
	{14, 2},
	{18, 2},
	{22, 2},
	{26, 2},
	{30, 3},
	{38, 3},
	{46, 3},
	{54, 3},
	{62, 3},
	{70, 3},
	{78, 3},
	{86, 4},
	{102, 4},
	{118, 4},
	{134, 4},
	{150, 5},
	{182, 5},
	{214, 5},
	{246, 7},
}

var huffman_11 = []hcb_struct{
	{4, 0, 0},
	{4, 1, 1},
	{5, 16, 16},
	{5, 1, 0},
	{5, 0, 1},
	{5, 2, 1},
	{5, 1, 2},
	{5, 2, 2},
	{6, 1, 3},
	{6, 3, 1},
	{6, 3, 2},
	{6, 2, 0},
	{6, 2, 3},
	{6, 0, 2},
	{6, 3, 3},
	{6, 3, 3},
	{7, 4, 1},
	{7, 1, 4},
	{7, 4, 2},
	{7, 2, 4},
	{7, 4, 3},
	{7, 3, 4},
	{7, 3, 0},
	{7, 0, 3},
	{7, 5, 1},
	{7, 5, 2},
	{7, 2, 5},
	{7, 4, 4},
	{7, 1, 5},
	{7, 5, 3},
	{7, 3, 5},
	{7, 3, 5},
	{7, 5, 4},
	{7, 5, 4},
	{8, 4, 5},
	{8, 6, 2},
	{8, 2, 6},
	{8, 6, 1},
	{8, 6, 3},
	{8, 3, 6},
	{8, 1, 6},
	{8, 4, 16},
	{8, 3, 16},
	{8, 16, 5},
	{8, 16, 3},
	{8, 16, 4},
	{8, 6, 4},
	{8, 16, 6},
	{8, 4, 0},
	{8, 4, 6},
	{8, 0, 4},
	{8, 2, 16},
	{8, 5, 5},
	{8, 5, 16},
	{8, 16, 7},
	{8, 16, 2},
	{8, 16, 8},
	{8, 2, 7},
	{8, 7, 2},
	{8, 3, 7},
	{8, 6, 5},
	{8, 5, 6},
	{8, 6, 16},
	{8, 16, 10},
	{8, 7, 3},
	{8, 7, 1},
	{8, 16, 9},
	{8, 7, 16},
	{8, 1, 16},
	{8, 1, 7},
	{8, 4, 7},
	{8, 16, 11},
	{8, 7, 4},
	{8, 16, 12},
	{8, 8, 16},
	{8, 16, 1},
	{8, 6, 6},
	{8, 9, 16},
	{8, 2, 8},
	{8, 5, 7},
	{8, 10, 16},
	{8, 16, 13},
	{8, 8, 3},
	{8, 8, 2},
	{8, 3, 8},
	{8, 5, 0},
	{8, 16, 14},
	{8, 16, 14},
	{8, 11, 16},
	{8, 11, 16},
	{8, 7, 5},
	{8, 7, 5},
	{8, 4, 8},
	{8, 4, 8},
	{8, 6, 7},
	{8, 6, 7},
	{8, 7, 6},
	{8, 7, 6},
	{8, 0, 5},
	{8, 0, 5},
	{9, 8, 4},
	{9, 16, 15},
	{9, 12, 16},
	{9, 1, 8},
	{9, 8, 1},
	{9, 14, 16},
	{9, 5, 8},
	{9, 13, 16},
	{9, 3, 9},
	{9, 8, 5},
	{9, 7, 7},
	{9, 2, 9},
	{9, 8, 6},
	{9, 9, 2},
	{9, 9, 3},
	{9, 15, 16},
	{9, 4, 9},
	{9, 6, 8},
	{9, 6, 0},
	{9, 9, 4},
	{9, 5, 9},
	{9, 8, 7},
	{9, 7, 8},
	{9, 1, 9},
	{9, 10, 3},
	{9, 0, 6},
	{9, 10, 2},
	{9, 9, 1},
	{9, 9, 5},
	{9, 4, 10},
	{9, 2, 10},
	{9, 9, 6},
	{9, 3, 10},
	{9, 6, 9},
	{9, 10, 4},
	{9, 8, 8},
	{9, 10, 5},
	{9, 9, 7},
	{9, 11, 3},
	{9, 1, 10},
	{9, 7, 0},
	{9, 10, 6},
	{9, 7, 9},
	{9, 3, 11},
	{9, 5, 10},
	{9, 10, 1},
	{9, 4, 11},
	{9, 11, 2},
	{9, 13, 2},
	{9, 6, 10},
	{9, 13, 3},
	{9, 13, 3},
	{9, 2, 11},
	{9, 2, 11},
	{9, 16, 0},
	{9, 16, 0},
	{9, 5, 11},
	{9, 5, 11},
	{9, 11, 5},
	{9, 11, 5},
	{10, 11, 4},
	{10, 9, 8},
	{10, 7, 10},
	{10, 8, 9},
	{10, 0, 16},
	{10, 4, 13},
	{10, 0, 7},
	{10, 3, 13},
	{10, 11, 6},
	{10, 13, 1},
	{10, 13, 4},
	{10, 12, 3},
	{10, 2, 13},
	{10, 13, 5},
	{10, 8, 10},
	{10, 6, 11},
	{10, 10, 8},
	{10, 10, 7},
	{10, 14, 2},
	{10, 12, 4},
	{10, 1, 11},
	{10, 4, 12},
	{10, 11, 1},
	{10, 3, 12},
	{10, 1, 13},
	{10, 12, 2},
	{10, 7, 11},
	{10, 3, 14},
	{10, 5, 12},
	{10, 5, 13},
	{10, 14, 4},
	{10, 4, 14},
	{10, 11, 7},
	{10, 14, 3},
	{10, 12, 5},
	{10, 13, 6},
	{10, 12, 6},
	{10, 8, 0},
	{10, 11, 8},
	{10, 2, 12},
	{10, 9, 9},
	{10, 14, 5},
	{10, 6, 13},
	{10, 10, 10},
	{10, 15, 2},
	{10, 8, 11},
	{10, 9, 10},
	{10, 14, 6},
	{10, 10, 9},
	{10, 5, 14},
	{10, 11, 9},
	{10, 14, 1},
	{10, 2, 14},
	{10, 6, 12},
	{10, 1, 12},
	{10, 13, 8},
	{10, 0, 8},
	{10, 13, 7},
	{10, 7, 12},
	{10, 12, 7},
	{10, 7, 13},
	{10, 15, 3},
	{10, 12, 1},
	{10, 6, 14},
	{10, 2, 15},
	{10, 15, 5},
	{10, 15, 4},
	{10, 1, 14},
	{10, 9, 11},
	{10, 4, 15},
	{10, 14, 7},
	{10, 8, 13},
	{10, 13, 9},
	{10, 8, 12},
	{10, 5, 15},
	{10, 3, 15},
	{10, 10, 11},
	{10, 11, 10},
	{10, 12, 8},
	{10, 15, 6},
	{10, 15, 7},
	{10, 8, 14},
	{10, 15, 1},
	{10, 7, 14},
	{10, 9, 0},
	{10, 0, 9},
	{10, 9, 13},
	{10, 9, 13},
	{10, 9, 13},
	{10, 9, 13},
	{10, 9, 12},
	{10, 9, 12},
	{10, 9, 12},
	{10, 9, 12},
	{10, 12, 9},
	{10, 12, 9},
	{10, 12, 9},
	{10, 12, 9},
	{10, 14, 8},
	{10, 14, 8},
	{10, 14, 8},
	{10, 14, 8},
	{10, 10, 13},
	{10, 10, 13},
	{10, 10, 13},
	{10, 10, 13},
	{10, 14, 9},
	{10, 14, 9},
	{10, 14, 9},
	{10, 14, 9},
	{10, 12, 10},
	{10, 12, 10},
	{10, 12, 10},
	{10, 12, 10},
	{10, 6, 15},
	{10, 6, 15},
	{10, 6, 15},
	{10, 6, 15},
	{10, 7, 15},
	{10, 7, 15},
	{10, 7, 15},
	{10, 7, 15},
	{11, 9, 14},
	{11, 9, 14},
	{11, 15, 8},
	{11, 15, 8},
	{11, 11, 11},
	{11, 11, 11},
	{11, 11, 14},
	{11, 11, 14},
	{11, 1, 15},
	{11, 1, 15},
	{11, 10, 12},
	{11, 10, 12},
	{11, 10, 14},
	{11, 10, 14},
	{11, 13, 11},
	{11, 13, 11},
	{11, 13, 10},
	{11, 13, 10},
	{11, 11, 13},
	{11, 11, 13},
	{11, 11, 12},
	{11, 11, 12},
	{11, 8, 15},
	{11, 8, 15},
	{11, 14, 11},
	{11, 14, 11},
	{11, 13, 12},
	{11, 13, 12},
	{11, 12, 13},
	{11, 12, 13},
	{11, 15, 9},
	{11, 15, 9},
	{11, 14, 10},
	{11, 14, 10},
	{11, 10, 0},
	{11, 10, 0},
	{11, 12, 11},
	{11, 12, 11},
	{11, 9, 15},
	{11, 9, 15},
	{11, 0, 10},
	{11, 0, 10},
	{11, 12, 12},
	{11, 12, 12},
	{11, 11, 0},
	{11, 11, 0},
	{11, 12, 14},
	{11, 12, 14},
	{11, 10, 15},
	{11, 10, 15},
	{11, 13, 13},
	{11, 13, 13},
	{11, 0, 13},
	{11, 0, 13},
	{11, 14, 12},
	{11, 14, 12},
	{11, 15, 10},
	{11, 15, 10},
	{11, 15, 11},
	{11, 15, 11},
	{11, 11, 15},
	{11, 11, 15},
	{11, 14, 13},
	{11, 14, 13},
	{11, 13, 0},
	{11, 13, 0},
	{11, 0, 11},
	{11, 0, 11},
	{11, 13, 14},
	{11, 13, 14},
	{11, 15, 12},
	{11, 15, 12},
	{11, 15, 13},
	{11, 15, 13},
	{11, 12, 15},
	{11, 12, 15},
	{11, 14, 0},
	{11, 14, 0},
	{11, 14, 14},
	{11, 14, 14},
	{11, 13, 15},
	{11, 13, 15},
	{11, 12, 0},
	{11, 12, 0},
	{11, 14, 15},
	{11, 14, 15},
	{12, 0, 14},
	{12, 0, 12},
	{12, 15, 14},
	{12, 15, 0},
	{12, 0, 15},
	{12, 15, 15},
}

var hcb_2step_bits = [...]uint8{
	0, 5, 5, 0, 5, 0, 5, 0, 5, 0, 6, 5,
}

var hcb_2step = [...]([]hcb_struct_1){
	nil, huffman_01_1, huffman_02_1, nil, huffman_04_1, nil, huffman_06_1, nil, huffman_08_1, nil, huffman_10_1, huffman_11_1,
}

var hcb_table_size = [...]uint16{
	0, 114, 86, 161, 185, 161, 126, 127, 83, 337, 210, 374,
}

var hcb_table = [...]([]hcb_struct){
	nil, huffman_01, huffman_02, huffman_03, huffman_04, huffman_05, huffman_06, huffman_07, huffman_08, huffman_09, huffman_10, huffman_11,
}

// The MediaInfo implementation doesn't have any comments, so we'll leave some here.
// This function effectively uses a Huffman tree flattened into a 2D array for binary search.
// Each leaf node is indicated by a 0 in the 2nd position.  The first element and
// non-zero 2nd elements are mathmatical offsets into the array. The value is
// chosen  based on the value of the next bit in the Huffman encoding word from the bitstream.
func hcod_sf(reader *bitreader.BitReader) (uint8, error) {
	Pos := uint8(0)
	for huffman_sf[Pos][1] != 0 {
		h, _ := reader.ReadBitsAsUInt8(1)
		Pos += huffman_sf[Pos][h]

		if Pos > 240 {
			return 255, fmt.Errorf("Error: Scale Factor Huffman encoded position (%d) out of range", Pos)
		}
	}
	return (huffman_sf[Pos][0]), nil
}

// 2 step lookup is used when possible
func hcod_2step(reader *bitreader.BitReader, codebook uint8, values []int8) error {
	toRead := hcb_2step_bits[codebook]
	// Ensure we don't run off our buffer
	if uint(toRead) > reader.BitsLeft() {
		toRead = uint8(reader.BitsLeft())
	}

	codeWord, _ := reader.PeekBits(uint(toRead))
	offset := uint(hcb_2step[codebook][codeWord].Offset)
	extra := uint(hcb_2step[codebook][codeWord].Extra)

	if extra > 0 {
		reader.SkipBits(uint(hcb_2step_bits[codebook]))
		offset_incr, _ := reader.PeekBits(extra)
		offset += offset_incr
		if skip := hcb_table[codebook][offset][0] - int8(hcb_2step_bits[codebook]); skip > 0 {
			reader.SkipBits(uint(skip))
		}
	} else {
		reader.SkipBits(uint(hcb_table[codebook][offset][0]))
	}

	if offset > uint(hcb_table_size[codebook]) {
		return fmt.Errorf("Error: Binary search offset (%d) for Huffman word out of bounds (%d)",
			offset, hcb_table[codebook])
	}

	for i := range values {
		values[i] = hcb_table[codebook][offset][i+1]
	}
	return nil
}

// binary seach is used when the 2 step lookup table would use tons of memory
func hcod_binary(reader *bitreader.BitReader, codebook uint8, values []int8) error {
	offset := uint16(0)
	for hcb_table[codebook][offset][0] == 0 {
		bit, err := reader.ReadBit()
		if err != nil {
			return err
		}

		offset += uint16(hcb_table[codebook][offset][1+bit])
	}

	if offset >= hcb_table_size[codebook] {
		return fmt.Errorf("Error: Binary search offset (%d) for Huffman word out of bounds (%d)",
			offset, hcb_table[codebook])
	}

	for i := 0; i < cap(values); i++ {
		values[i] = hcb_table[codebook][offset][i+1]
	}
	return nil
}

// Select the correct lookup method based on the codebook
func hcod(reader *bitreader.BitReader, sect_cb uint8) ([]int8, error) {
	var err error
	var values []int8

	// call the optimal search method for each case
	switch sect_cb {
	case 1, 2, 4:
		values = make([]int8, 4)
		err = hcod_2step(reader, sect_cb, values)
	case 3:
		values = make([]int8, 4)
		err = hcod_binary(reader, sect_cb, values)
	case 5, 7, 9:
		values = make([]int8, 2)
		err = hcod_binary(reader, sect_cb, values)
	case 6, 8, 10, 11:
		values = make([]int8, 2)
		err = hcod_2step(reader, sect_cb, values)
	default:
		return values, fmt.Errorf("Error: codebook (%d) is unsupported", sect_cb)
	}

	if err != nil {
		return values, err
	}

	// account for sign bits in the bitstream
	switch sect_cb {
	case 1, 2, 5, 6:
	default:
		for i := range values {
			if values[i] != 0 {
				if sign, _ := reader.ReadBitAsBool(); sign {
					values[i] = -values[i]
				}
			}
		}
	}

	// with escape
	switch sect_cb {
	case 11:
		for i := 0; i < 2; i++ {
			if values[i] == 16 || values[i] == -16 {
				esc := true
				bitcount := uint(3)
				for esc {
					bitcount++
					esc, _ = reader.ReadBitAsBool()
				}
				offset, _ := reader.ReadBitsAsInt(bitcount)

				val := int8(offset | (1 << bitcount))
				if values[i] < 0 {
					values[i] = -val
				} else {
					values[i] = val
				}
			}
		}
	}

	return values, nil
}

// BEGIN SBR
// huffman tables referenced from FAAD2
// http://www.audiocoding.com/faad2.html

var t_huffman_env_1_5dB = [][]int8{
	{1, 2}, {-64, -65}, {3, 4}, {-63, -66},
	{5, 6}, {-62, -67}, {7, 8}, {-61, -68},
	{9, 10}, {-60, -69}, {11, 12}, {-59, -70},
	{13, 14}, {-58, -71}, {15, 16}, {-57, -72},
	{17, 18}, {-73, -56}, {19, 21}, {-74, 20},
	{-55, -75}, {22, 26}, {23, 24}, {-54, -76},
	{-77, 25}, {-53, -78}, {27, 34}, {28, 29},
	{-52, -79}, {30, 31}, {-80, -51}, {32, 33},
	{-83, -82}, {-81, -50}, {35, 57}, {36, 40},
	{37, 38}, {-88, -84}, {-48, 39}, {-90, -85},
	{41, 46}, {42, 43}, {-49, -87}, {44, 45},
	{-89, -86}, {-124, -123}, {47, 50}, {48, 49},
	{-122, -121}, {-120, -119}, {51, 54}, {52, 53},
	{-118, -117}, {-116, -115}, {55, 56}, {-114, -113},
	{-112, -111}, {58, 89}, {59, 74}, {60, 67},
	{61, 64}, {62, 63}, {-110, -109}, {-108, -107},
	{65, 66}, {-106, -105}, {-104, -103}, {68, 71},
	{69, 70}, {-102, -101}, {-100, -99}, {72, 73},
	{-98, -97}, {-96, -95}, {75, 82}, {76, 79},
	{77, 78}, {-94, -93}, {-92, -91}, {80, 81},
	{-47, -46}, {-45, -44}, {83, 86}, {84, 85},
	{-43, -42}, {-41, -40}, {87, 88}, {-39, -38},
	{-37, -36}, {90, 105}, {91, 98}, {92, 95},
	{93, 94}, {-35, -34}, {-33, -32}, {96, 97},
	{-31, -30}, {-29, -28}, {99, 102}, {100, 101},
	{-27, -26}, {-25, -24}, {103, 104}, {-23, -22},
	{-21, -20}, {106, 113}, {107, 110}, {108, 109},
	{-19, -18}, {-17, -16}, {111, 112}, {-15, -14},
	{-13, -12}, {114, 117}, {115, 116}, {-11, -10},
	{-9, -8}, {118, 119}, {-7, -6}, {-5, -4},
}

var f_huffman_env_1_5dB = [][]int8{
	{1, 2}, {-64, -65}, {3, 4}, {-63, -66},
	{5, 6}, {-67, -62}, {7, 8}, {-68, -61},
	{9, 10}, {-69, -60}, {11, 13}, {-70, 12},
	{-59, -71}, {14, 16}, {-58, 15}, {-72, -57},
	{17, 19}, {-73, 18}, {-56, -74}, {20, 23},
	{21, 22}, {-55, -75}, {-54, -53}, {24, 27},
	{25, 26}, {-76, -52}, {-77, -51}, {28, 31},
	{29, 30}, {-50, -78}, {-79, -49}, {32, 36},
	{33, 34}, {-48, -47}, {-80, 35}, {-81, -82},
	{37, 47}, {38, 41}, {39, 40}, {-83, -46},
	{-45, -84}, {42, 44}, {-85, 43}, {-44, -43},
	{45, 46}, {-88, -87}, {-86, -90}, {48, 66},
	{49, 56}, {50, 53}, {51, 52}, {-92, -42},
	{-41, -39}, {54, 55}, {-105, -89}, {-38, -37},
	{57, 60}, {58, 59}, {-94, -91}, {-40, -36},
	{61, 63}, {-20, 62}, {-115, -110}, {64, 65},
	{-108, -107}, {-101, -97}, {67, 89}, {68, 75},
	{69, 72}, {70, 71}, {-95, -93}, {-34, -27},
	{73, 74}, {-22, -17}, {-16, -124}, {76, 82},
	{77, 79}, {-123, 78}, {-122, -121}, {80, 81},
	{-120, -119}, {-118, -117}, {83, 86}, {84, 85},
	{-116, -114}, {-113, -112}, {87, 88}, {-111, -109},
	{-106, -104}, {90, 105}, {91, 98}, {92, 95},
	{93, 94}, {-103, -102}, {-100, -99}, {96, 97},
	{-98, -96}, {-35, -33}, {99, 102}, {100, 101},
	{-32, -31}, {-30, -29}, {103, 104}, {-28, -26},
	{-25, -24}, {106, 113}, {107, 110}, {108, 109},
	{-23, -21}, {-19, -18}, {111, 112}, {-15, -14},
	{-13, -12}, {114, 117}, {115, 116}, {-11, -10},
	{-9, -8}, {118, 119}, {-7, -6}, {-5, -4},
}

var t_huffman_env_bal_1_5dB = [][]int8{
	{-64, 1}, {-63, 2}, {-65, 3}, {-62, 4},
	{-66, 5}, {-61, 6}, {-67, 7}, {-60, 8},
	{-68, 9}, {10, 11}, {-69, -59}, {12, 13},
	{-70, -58}, {14, 28}, {15, 21}, {16, 18},
	{-57, 17}, {-71, -56}, {19, 20}, {-88, -87},
	{-86, -85}, {22, 25}, {23, 24}, {-84, -83},
	{-82, -81}, {26, 27}, {-80, -79}, {-78, -77},
	{29, 36}, {30, 33}, {31, 32}, {-76, -75},
	{-74, -73}, {34, 35}, {-72, -55}, {-54, -53},
	{37, 41}, {38, 39}, {-52, -51}, {-50, 40},
	{-49, -48}, {42, 45}, {43, 44}, {-47, -46},
	{-45, -44}, {46, 47}, {-43, -42}, {-41, -40},
}

var f_huffman_env_bal_1_5dB = [][]int8{
	{-64, 1}, {-65, 2}, {-63, 3}, {-66, 4},
	{-62, 5}, {-61, 6}, {-67, 7}, {-68, 8},
	{-60, 9}, {10, 11}, {-69, -59}, {-70, 12},
	{-58, 13}, {14, 17}, {-71, 15}, {-57, 16},
	{-56, -73}, {18, 32}, {19, 25}, {20, 22},
	{-72, 21}, {-88, -87}, {23, 24}, {-86, -85},
	{-84, -83}, {26, 29}, {27, 28}, {-82, -81},
	{-80, -79}, {30, 31}, {-78, -77}, {-76, -75},
	{33, 40}, {34, 37}, {35, 36}, {-74, -55},
	{-54, -53}, {38, 39}, {-52, -51}, {-50, -49},
	{41, 44}, {42, 43}, {-48, -47}, {-46, -45},
	{45, 46}, {-44, -43}, {-42, 47}, {-41, -40},
}

var t_huffman_env_3_0dB = [][]int8{
	{-64, 1}, {-65, 2}, {-63, 3}, {-66, 4},
	{-62, 5}, {-67, 6}, {-61, 7}, {-68, 8},
	{-60, 9}, {10, 11}, {-69, -59}, {12, 14},
	{-70, 13}, {-71, -58}, {15, 18}, {16, 17},
	{-72, -57}, {-73, -74}, {19, 22}, {-56, 20},
	{-55, 21}, {-54, -77}, {23, 31}, {24, 25},
	{-75, -76}, {26, 27}, {-78, -53}, {28, 29},
	{-52, -95}, {-94, 30}, {-93, -92}, {32, 47},
	{33, 40}, {34, 37}, {35, 36}, {-91, -90},
	{-89, -88}, {38, 39}, {-87, -86}, {-85, -84},
	{41, 44}, {42, 43}, {-83, -82}, {-81, -80},
	{45, 46}, {-79, -51}, {-50, -49}, {48, 55},
	{49, 52}, {50, 51}, {-48, -47}, {-46, -45},
	{53, 54}, {-44, -43}, {-42, -41}, {56, 59},
	{57, 58}, {-40, -39}, {-38, -37}, {60, 61},
	{-36, -35}, {-34, -33},
}

var f_huffman_env_3_0dB = [][]int8{
	{-64, 1}, {-65, 2}, {-63, 3}, {-66, 4},
	{-62, 5}, {-67, 6}, {7, 8}, {-61, -68},
	{9, 10}, {-60, -69}, {11, 12}, {-59, -70},
	{13, 14}, {-58, -71}, {15, 16}, {-57, -72},
	{17, 19}, {-56, 18}, {-55, -73}, {20, 24},
	{21, 22}, {-74, -54}, {-53, 23}, {-75, -76},
	{25, 30}, {26, 27}, {-52, -51}, {28, 29},
	{-77, -79}, {-50, -49}, {31, 39}, {32, 35},
	{33, 34}, {-78, -46}, {-82, -88}, {36, 37},
	{-83, -48}, {-47, 38}, {-86, -85}, {40, 47},
	{41, 44}, {42, 43}, {-80, -44}, {-43, -42},
	{45, 46}, {-39, -87}, {-84, -40}, {48, 55},
	{49, 52}, {50, 51}, {-95, -94}, {-93, -92},
	{53, 54}, {-91, -90}, {-89, -81}, {56, 59},
	{57, 58}, {-45, -41}, {-38, -37}, {60, 61},
	{-36, -35}, {-34, -33},
}

var t_huffman_env_bal_3_0dB = [][]int8{
	{-64, 1}, {-63, 2}, {-65, 3}, {-66, 4},
	{-62, 5}, {-61, 6}, {-67, 7}, {-68, 8},
	{-60, 9}, {10, 16}, {11, 13}, {-69, 12},
	{-76, -75}, {14, 15}, {-74, -73}, {-72, -71},
	{17, 20}, {18, 19}, {-70, -59}, {-58, -57},
	{21, 22}, {-56, -55}, {-54, 23}, {-53, -52},
}

var f_huffman_env_bal_3_0dB = [][]int8{
	{-64, 1}, {-65, 2}, {-63, 3}, {-66, 4},
	{-62, 5}, {-61, 6}, {-67, 7}, {-68, 8},
	{-60, 9}, {10, 13}, {-69, 11}, {-59, 12},
	{-58, -76}, {14, 17}, {15, 16}, {-75, -74},
	{-73, -72}, {18, 21}, {19, 20}, {-71, -70},
	{-57, -56}, {22, 23}, {-55, -54}, {-53, -52},
}

var t_huffman_noise_3_0dB = [][]int8{
	{-64, 1}, {-63, 2}, {-65, 3}, {-66, 4},
	{-62, 5}, {-67, 6}, {7, 8}, {-61, -68},
	{9, 30}, {10, 15}, {-60, 11}, {-69, 12},
	{13, 14}, {-59, -53}, {-95, -94}, {16, 23},
	{17, 20}, {18, 19}, {-93, -92}, {-91, -90},
	{21, 22}, {-89, -88}, {-87, -86}, {24, 27},
	{25, 26}, {-85, -84}, {-83, -82}, {28, 29},
	{-81, -80}, {-79, -78}, {31, 46}, {32, 39},
	{33, 36}, {34, 35}, {-77, -76}, {-75, -74},
	{37, 38}, {-73, -72}, {-71, -70}, {40, 43},
	{41, 42}, {-58, -57}, {-56, -55}, {44, 45},
	{-54, -52}, {-51, -50}, {47, 54}, {48, 51},
	{49, 50}, {-49, -48}, {-47, -46}, {52, 53},
	{-45, -44}, {-43, -42}, {55, 58}, {56, 57},
	{-41, -40}, {-39, -38}, {59, 60}, {-37, -36},
	{-35, 61}, {-34, -33},
}

var t_huffman_noise_bal_3_0dB = [][]int8{
	{-64, 1}, {-65, 2}, {-63, 3}, {4, 9},
	{-66, 5}, {-62, 6}, {7, 8}, {-76, -75},
	{-74, -73}, {10, 17}, {11, 14}, {12, 13},
	{-72, -71}, {-70, -69}, {15, 16}, {-68, -67},
	{-61, -60}, {18, 21}, {19, 20}, {-59, -58},
	{-57, -56}, {22, 23}, {-55, -54}, {-53, -52},
}

func sbr_huff_dec(reader *bitreader.BitReader, t_huff [][]int8) int {
	index := 0

	for index >= 0 {
		bit, _ := reader.ReadBit()
		index = int(t_huff[index][bit])
	}

	return index + 64
}
